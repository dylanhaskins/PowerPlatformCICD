var Filter;!function(t){!function(t){function e(t){return null==t?"null":"string"==typeof t?"'"+t+"'":"[object Date]"===Object.prototype.toString.call(t)?"DateTime'"+t.format("yyyy-MM-ddTHH:mm:ss")+"'":t.toString()}function n(t,n,r){return e(t)+" "+n+" "+e(r)}function r(t,n,r){return t+"("+e(n)+", "+e(r)+")"}function i(t,e,n){return"("+t+" "+e+" "+n+")"}function o(t,e){var n=t.pop();return void 0===n?"":t.reduceRight(function(t,n){return i(n,e,t)},n)}t.equals=function(t,e){return n(t,"eq",e)},t.notEquals=function(t,e){return n(t,"ne",e)},t.greaterThan=function(t,e){return n(t,"gt",e)},t.greaterThanOrEqual=function(t,e){return n(t,"ge",e)},t.lessThan=function(t,e){return n(t,"lt",e)},t.lessThanOrEqual=function(t,e){return n(t,"le",e)},t.and=function(t,e){return i(t,"and",e)},t.or=function(t,e){return i(t,"or",e)},t.not=function(t){return"not "+t},t.ands=function(t){return o(t,"and")},t.ors=function(t){return o(t,"or")},t.startsWith=function(t,e){return r("startswith",t,e)},t.substringOf=function(t,e){return r("substringof",t,e)},t.endsWith=function(t,e){return r("endswith",t,e)},t.makeGuid=function(t){return XQR.makeTag("(guid'"+t+"')")}}(t.REST||(t.REST={}))}(Filter||(Filter={}));var XrmQuery;!function(t){!function(t){function e(t){return t.startsWith("{")&&t.endsWith("}")?t.substring(1,t.length-1):t}t.stripGUID=e,t.retrieveRecord=function(t,n){return new XQR.RetrieveRecord(t,e(n))},t.retrieveMultipleRecords=function(t){return new XQR.RetrieveMultipleRecords(t)},t.createRecord=function(t,e){return new XQR.CreateRecord(t,e)},t.updateRecord=function(t,n,r){return new XQR.UpdateRecord(t,e(n),r)},t.deleteRecord=function(t,n){return new XQR.DeleteRecord(t,e(n))}}(t.REST||(t.REST={}))}(XrmQuery||(XrmQuery={}));var XQR;!function(t){function e(t){return{__str:t,toString:function(){return this.__str}}}function n(t){return t(o(t))}function r(t){return new RegExp("\\b"+t+"\\.([a-zA-Z_$][0-9a-zA-Z_$]*)(\\.([a-zA-Z_$][0-9a-zA-Z_$]*))?","g")}function i(t){var e=t.toString().match(s);if(!e)throw new Error("XrmQuery: Unable to properly parse function: "+t.toString());return{arg:e[1],body:e[2]}}function o(t){for(var n,o=i(t),s=r(o.arg),u={};null!=(n=s.exec(o.body));)u[n[1]]||(u[n[1]]=e(n[1])),n[3]&&(u[n[1]][n[3]]=e(n[1]+"/"+n[3]));return u}t.makeTag=e;var s=/function[^\(]*\(([a-zA-Z0-9_]+)[^\{]*\{([\s\S]*)\}$/m,u=function(){},c=function(){function t(t,e){this.selects=[],this.expands=[],this.logicalName=n(t).toString(),this.id=e}return t.prototype.select=function(t){return this.selects=this.selects.concat(n(t)),this},t.prototype.expand=function(t,e){var r=n(t).toString();return this.expands.push(r),e&&(this.selects=this.selects.concat(n(e).map(function(t){return r+"."+t}))),this},t.prototype.execute=function(t,e){SDK.REST.retrieveRecord(this.id,this.logicalName,this.selects.length>0?this.selects.join(","):null,this.expands.length>0?this.expands.join(","):null,t,e||u)},t}();t.RetrieveRecord=c;var l=function(){function t(t){this.selects=[],this.expands=[],this.ordering=[],this.skipAmount=null,this.topAmount=null,this.logicalName=n(t).toString()}return t.prototype.select=function(t){return this.selects=this.selects.concat(n(t)),this},t.prototype.expand=function(t,e){var r=n(t).toString();return this.expands.push(r),e&&(this.selects=this.selects.concat(n(e).map(function(t){return r+"/"+t}))),this},t.prototype.filter=function(t){return this.filters=n(t),this},t.prototype.orFilter=function(t){return this.filters?this.filters=Filter.REST.or(this.filters,n(t)):this.filter(t),this},t.prototype.andFilter=function(t){return this.filters?this.filters=Filter.REST.and(this.filters,n(t)):this.filter(t),this},t.prototype.order=function(t,e){return this.ordering.push(n(t)+" "+e),this},t.prototype.orderAsc=function(t){return this.order(t,"asc")},t.prototype.orderDesc=function(t){return this.order(t,"desc")},t.prototype.skip=function(t){return this.skipAmount=t,this},t.prototype.top=function(t){return this.topAmount=t,this},t.prototype.execute=function(t,e,n){SDK.REST.retrieveMultipleRecords(this.logicalName,this.getOptionString(),t,e,n)},t.prototype.getAll=function(t,e){var n=[];SDK.REST.retrieveMultipleRecords(this.logicalName,this.getOptionString(),function(t){n.push(t)},e||u,function(){t([].concat.apply([],n))})},t.prototype.getFirst=function(t,e){this.top(1),this.execute(function(e){return t(e.length>0?e[0]:null)},e||u,u)},t.prototype.getOptionString=function(){var t=[];return this.selects.length>0&&t.push("$select="+this.selects.join(",")),this.expands.length>0&&t.push("$expand="+this.expands.join(",")),this.filters&&t.push("$filter="+this.filters),this.ordering.length>0&&t.push("$orderby="+this.ordering.join(",")),null!=this.skipAmount&&t.push("$skip="+this.skipAmount),null!=this.topAmount&&t.push("$top="+this.topAmount),t.join("&")},t}();t.RetrieveMultipleRecords=l;var h=function(){function t(t,e){this.logicalName=n(t).toString(),this.record=e}return t.prototype.execute=function(t,e){SDK.REST.createRecord(this.record,this.logicalName,t||u,e||u)},t}();t.CreateRecord=h;var a=function(){function t(t,e,r){this.logicalName=n(t).toString(),this.id=e,this.record=r}return t.prototype.execute=function(t,e){SDK.REST.updateRecord(this.id,this.record,this.logicalName,t||u,e||u)},t}();t.UpdateRecord=a;var p=function(){function t(t,e){this.logicalName=n(t).toString(),this.id=e}return t.prototype.execute=function(t,e){SDK.REST.deleteRecord(this.id,this.logicalName,t||u,e||u)},t}();t.DeleteRecord=p}(XQR||(XQR={}));
